# Google Drive Structure & Document References

## Overview
Complete Google Drive folder structure for Bin Quraya RFQ system. These documents are used by the AI to understand requirements and process vendor responses.

**IMPORTANT**: The AI must be able to read and understand these documents dynamically, not rely on hard-coded data.

## Folder Structure

```
_davon DEMO SANDBOX/
├── 1_Project_Initiation_Docs/
├── 2_RFQ_Templates/
├── 3_Incoming_Vendor_Offers/
├── 4_Technical_Evaluations/
├── 5_Commercial_Evaluations/
├── 6_Decision_Packages/
├── 7_Purchase_Orders/
└── 8_Closed_RFQs_Archive/
```

## Key Documents & Their Purpose

### 1. Project Initiation Documents
Located in: `1_Project_Initiation_Docs/`

#### PE-7-MEMO-001_Procurement_Initiation.pdf
- **File ID**: `1uLtG5JFWLYZeDck0eN3CxuCYpuTqLWbG`
- **Purpose**: Initiates RFQ process
- **AI Extraction Required**:
  ```json
  {
    "project_id": "P-SAOO-0092548",
    "project_name": "Heat Exchanger Replacement",
    "commodity_code": "450-012547",
    "quantity_required": 2,
    "technical_requirements": "SS 316L material grade",
    "delivery_location": "Yanbu Refinery",
    "budget_estimate": "$50,000"
  }
  ```

### 2. RFQ Templates
Located in: `2_RFQ_Templates/`

#### 9COM_to_AVL_Master_List.xlsx
- **Sheet ID**: `1OGSzKu47JnXgb51rpftjALOOaP_9jL-3oFev5UbmYiQ`
- **Purpose**: Maps commodity codes to approved vendor lists
- **Structure**:
  | 9COM Code | Description | AVL Document |
  |-----------|-------------|--------------|
  | 450-012547 | Heat Exchanger, High Pressure | AVL-HEAT-EXCHANGERS-Rev4.pdf |
  | 450-019283 | Valve, Control | AVL-CONTROL-VALVES-Rev2.pdf |

#### AVL-HEAT-EXCHANGERS-Rev4.pdf
- **File ID**: `15f_sNr9BJDVltzU-RwkhLSoB_b0yECUe`
- **Purpose**: Lists approved vendors for heat exchangers
- **AI Extraction Required**:
  ```json
  {
    "commodity": "Heat Exchangers",
    "approved_vendors": [
      {
        "vendor_id": "9V-1102",
        "vendor_name": "Vendor A Industries",
        "vendor_email": "vendor.a.demo@gmail.com",
        "status": "Active",
        "approval_date": "2023-05-15"
      },
      {
        "vendor_id": "9V-4354",
        "vendor_name": "Vendor B Solutions",
        "vendor_email": "vendor.b.demo@gmail.com",
        "status": "Active"
      },
      {
        "vendor_id": "9V-3291",
        "vendor_name": "Vendor C Trading",
        "vendor_email": "vendor.c.demo@gmail.com",
        "status": "Active"
      }
    ]
  }
  ```

#### BQ-PROC-STD-001_Technical_Compliance_Matrix_Rev2.pdf
- **Purpose**: Technical requirements checklist
- **Key Requirements**:
  - Material Grade: SS 316L (ASTM A240)
  - Design Standard: ASME Section VIII
  - Testing: Hydrostatic test at 1.5x design pressure
  - Certification: Material Test Certificates required
  - Inspection: Third-party inspection required

#### BQ-PROC-MODEL-001_Commercial_Vendor_Evaluation_Model.pdf
- **Purpose**: Scoring methodology for vendor evaluation
- **Scoring Formula**:
  ```
  Total Score = (Price × 0.35) + (Delivery × 0.30) + 
                (Payment × 0.20) + (Warranty × 0.10) + 
                (Compliance × 0.05)
  ```

### 3. Incoming Vendor Offers
Located in: `3_Incoming_Vendor_Offers/`

#### Folder Structure:
```
3_Incoming_Vendor_Offers/
├── Vendor_A/
│   ├── Folder ID: 1K-7cqHLANQWW0XKDOyM8OcOzH6KoT7P-
│   └── VA_Quotation_RFQ-2024-001.pdf
├── Vendor_B/
│   ├── Folder ID: 1dXXGW1aPRfL_5tKQGh9i1LClMqLAXbOS
│   └── VB_Technical_Commercial_Offer.pdf
└── Vendor_C/
    ├── Folder ID: 1L3j9Y7DkKuOjJBtVnOTn_1Tv1w7xqCZP
    └── VC_Proposal_Heat_Exchanger.pdf
```

#### Sample Vendor Quotations

**Vendor A - Compliant Offer**
- Material: SS 316L ✓
- Price: $48,500
- Delivery: 70 days
- Payment: 30/70
- Warranty: 24 months

**Vendor B - Non-Compliant Offer**  
- Material: SS 304 ✗ (Wrong grade)
- Price: $41,000
- Delivery: 55 days
- Payment: 20/80
- Warranty: 18 months
- **Requires TBC**

**Vendor C - Compliant Offer**
- Material: SS 316L ✓
- Price: $36,500
- Delivery: 60 days
- Payment: 10/90
- Warranty: 12 months

### 4. Technical Evaluations
Located in: `4_Technical_Evaluations/`

Generated by workflow after vendor response:
- `TE_Vendor_A_RFQ-2024-001.pdf` - Compliance confirmed
- `TE_Vendor_B_RFQ-2024-001.pdf` - TBC issued for material
- `TE_Vendor_C_RFQ-2024-001.pdf` - Compliance confirmed

### 5. Commercial Evaluations  
Located in: `5_Commercial_Evaluations/`

Generated after all responses received:
- `CE_Comparison_Matrix_RFQ-2024-001.xlsx`
- `CE_Scoring_Summary_RFQ-2024-001.pdf`

### 6. Decision Packages
Located in: `6_Decision_Packages/`

Final package for management:
- `DP_RFQ-2024-001_Executive_Summary.pdf`
- `DP_RFQ-2024-001_Full_Analysis.pdf`

### 7. Purchase Orders
Located in: `7_Purchase_Orders/`

After approval:
- `PO-2024-1847_Vendor_C_Trading.pdf`
- `Regret_Letters/` - For unsuccessful vendors

### 8. Archive
Located in: `8_Closed_RFQs_Archive/`

Complete RFQ folder moved here after closure.

## Google Drive Integration in n8n

### Reading Files
```javascript
// Google Drive node configuration
{
  "operation": "download",
  "fileId": "{{fileId}}",
  "outputFormat": "text",
  "googleDriveOutputFormat": "file"
}
```

### Monitoring Folders
```javascript
// List files in vendor folder
{
  "operation": "list", 
  "folderID": "1K-7cqHLANQWW0XKDOyM8OcOzH6KoT7P-",
  "fields": ["id", "name", "mimeType", "createdTime"],
  "orderBy": "createdTime desc"
}
```

### Creating Documents
```javascript
// Upload evaluation report
{
  "operation": "upload",
  "folderId": "{{targetFolder}}",
  "fileName": "CE_Report_{{rfqId}}.pdf",
  "fileContent": "{{pdfBinary}}"
}
```

## File Naming Conventions

### Standard Format
- RFQ Documents: `RFQ-YYYY-NNN_Description.ext`
- Vendor Offers: `VendorCode_RFQ-YYYY-NNN_Type.ext`
- Evaluations: `TE/CE_VendorName_RFQ-YYYY-NNN.ext`
- Purchase Orders: `PO-YYYY-NNNN_VendorName.pdf`

### Document Types
- `.pdf` - Formal documents, quotations
- `.xlsx` - Commercial data, comparison matrices
- `.docx` - Draft documents, templates
- `.msg/.eml` - Email archives

## Access Control

### Service Account Permissions
The n8n service account needs:
- Read: All folders
- Write: Folders 3-8
- Create: Ability to create subfolders
- Delete: None (archive only)

### Sharing Settings
- All documents: Accessible to RFQ team
- Decision packages: Restricted to management
- POs: Finance team added after creation

## Maintenance

### Weekly Tasks
1. Archive completed RFQs
2. Clean up duplicate files
3. Update AVL documents
4. Verify folder permissions

### Monthly Tasks
1. Backup critical documents
2. Review access logs
3. Update document templates
4. Clean old email attachments

## AI Considerations

### Document Processing
1. **PDF Text Extraction**: Use OCR if needed
2. **Excel Processing**: Read specific sheets/ranges
3. **Email Attachments**: Extract and process separately
4. **Large Files**: Process in chunks

### Error Handling
- Missing documents: Flag and continue
- Corrupted files: Log and request resubmission
- Access denied: Alert IT team
- Format issues: Attempt conversion

## Future Enhancements
1. Automatic folder structure creation
2. Document versioning system
3. Automated archival rules
4. Integration with SharePoint
5. Blockchain document verification
